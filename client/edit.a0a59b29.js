import{S as e,i as t,s as a,e as s,c as o,a as n,d as r,f as l,g as c,A as i,t as d,k as u,b as h,m as f,h as p,y as g,G as m,J as v,L as $,B as b,j as k,l as E,o as P,M as x,p as I,q as T,r as w,C as y,H as B,K as N,D as U,u as L,F as D,N as S,O,n as A,P as V,v as j,w as H}from"./client.2f94a70a.js";import{s as M,a as q,d as R,b as C,c as F,e as z,f as W,g as G,h as J,i as K,j as Q,k as X,l as Y,m as Z,t as _,n as ee,o as te,p as ae,B as se,q as oe}from"./Block.a09a7fee.js";import"./v4.96b22442.js";import{u as ne,g as re,s as le}from"./index.4309d992.js";function ce(e){let t,a,i,$,b,k,E,P,x,I,T;return{c(){t=s("span"),a=d(e[0]),i=u(),$=s("div"),b=s("button"),k=d("Edit"),E=u(),P=s("button"),x=d("Delete"),this.h()},l(s){t=o(s,"SPAN",{});var l=n(t);a=h(l,e[0]),l.forEach(r),i=f(s),$=o(s,"DIV",{class:!0});var c=n($);b=o(c,"BUTTON",{class:!0});var d=n(b);k=h(d,"Edit"),d.forEach(r),E=f(c),P=o(c,"BUTTON",{class:!0});var u=n(P);x=h(u,"Delete"),u.forEach(r),c.forEach(r),this.h()},h(){l(b,"class","svelte-1x1bio2"),l(P,"class","svelte-1x1bio2"),l($,"class","button-container")},m(s,o){c(s,t,o),p(t,a),c(s,i,o),c(s,$,o),p($,b),p(b,k),p($,E),p($,P),p(P,x),I||(T=[g(b,"click",e[9]),g(P,"click",e[10])],I=!0)},p(e,t){1&t&&m(a,e[0])},d(e){e&&r(t),e&&r(i),e&&r($),I=!1,v(T)}}}function ie(e){let t,a,i,m,b,k,E,P,x,I,T,w,y,B,N,U,L,D,S;return{c(){t=s("div"),a=s("label"),i=d("Name"),b=u(),k=s("input"),P=u(),x=s("label"),I=d("Link"),w=u(),y=s("input"),N=u(),U=s("button"),L=d("Done"),this.h()},l(e){t=o(e,"DIV",{class:!0});var s=n(t);a=o(s,"LABEL",{for:!0});var l=n(a);i=h(l,"Name"),l.forEach(r),b=f(s),k=o(s,"INPUT",{id:!0,class:!0}),P=f(s),x=o(s,"LABEL",{for:!0});var c=n(x);I=h(c,"Link"),c.forEach(r),w=f(s),y=o(s,"INPUT",{id:!0,class:!0}),N=f(s),U=o(s,"BUTTON",{class:!0});var d=n(U);L=h(d,"Done"),d.forEach(r),s.forEach(r),this.h()},h(){l(a,"for",m="item-text-"+e[2]),l(k,"id",E="item-text-"+e[2]),l(k,"class","svelte-1x1bio2"),l(x,"for",T="item-href-"+e[2]),l(y,"id",B="item-href-"+e[2]),l(y,"class","svelte-1x1bio2"),l(U,"class","svelte-1x1bio2"),l(t,"class","edit-panel svelte-1x1bio2")},m(s,o){c(s,t,o),p(t,a),p(a,i),p(t,b),p(t,k),$(k,e[0]),p(t,P),p(t,x),p(x,I),p(t,w),p(t,y),$(y,e[1]),p(t,N),p(t,U),p(U,L),D||(S=[g(k,"input",e[6]),g(y,"input",e[7]),g(U,"click",e[8])],D=!0)},p(e,t){4&t&&m!==(m="item-text-"+e[2])&&l(a,"for",m),4&t&&E!==(E="item-text-"+e[2])&&l(k,"id",E),1&t&&k.value!==e[0]&&$(k,e[0]),4&t&&T!==(T="item-href-"+e[2])&&l(x,"for",T),4&t&&B!==(B="item-href-"+e[2])&&l(y,"id",B),2&t&&y.value!==e[1]&&$(y,e[1])},d(e){e&&r(t),D=!1,v(S)}}}function de(e){let t;function a(e,t){return e[5]?ie:ce}let d=a(e),u=d(e);return{c(){t=s("div"),u.c(),this.h()},l(e){t=o(e,"DIV",{class:!0});var a=n(t);u.l(a),a.forEach(r),this.h()},h(){l(t,"class","item-container svelte-1x1bio2")},m(e,a){c(e,t,a),u.m(t,null)},p(e,[s]){d===(d=a(e))&&u?u.p(e,s):(u.d(1),u=d(e),u&&(u.c(),u.m(t,null)))},i:i,o:i,d(e){e&&r(t),u.d()}}}function ue(e,t,a){let s=!1,{text:o}=t,{href:n}=t,{index:r}=t,{handleDelete:l}=t,{handleUpdate:c}=t;return e.$$set=e=>{"text"in e&&a(0,o=e.text),"href"in e&&a(1,n=e.href),"index"in e&&a(2,r=e.index),"handleDelete"in e&&a(3,l=e.handleDelete),"handleUpdate"in e&&a(4,c=e.handleUpdate)},[o,n,r,l,c,s,function(){o=this.value,a(0,o)},function(){n=this.value,a(1,n)},()=>{a(5,s=!1),c()},()=>a(5,s=!0),()=>l(r)]}class he extends e{constructor(e){super(),t(this,e,ue,de,a,{text:0,href:1,index:2,handleDelete:3,handleUpdate:4})}}function fe(e,t,a){const s=e.slice();return s[15]=t[a],s[16]=t,s[17]=a,s}function pe(e,t){let a,s,o,n,l;function i(e){t[9].call(null,e,t[15])}function d(e){t[10].call(null,e,t[15])}let u={handleUpdate:t[3],handleDelete:t[5],index:t[17]};return void 0!==t[15].text&&(u.text=t[15].text),void 0!==t[15].href&&(u.href=t[15].href),s=new he({props:u}),D.push(()=>S(s,"text",i)),D.push(()=>S(s,"href",d)),{key:e,first:null,c(){a=b(),k(s.$$.fragment),this.h()},l(e){a=b(),E(s.$$.fragment,e),this.h()},h(){this.first=a},m(e,t){c(e,a,t),P(s,e,t),l=!0},p(e,a){t=e;const r={};1&a&&(r.index=t[17]),!o&&1&a&&(o=!0,r.text=t[15].text,x(()=>o=!1)),!n&&1&a&&(n=!0,r.href=t[15].href,x(()=>n=!1)),s.$set(r)},i(e){l||(I(s.$$.fragment,e),l=!0)},o(e){T(s.$$.fragment,e),l=!1},d(e){e&&r(a),w(s,e)}}}function ge(e){let t,a,i,m,b,k,E,P,x,w,L,D,S,O,A,V,j,H,M,q,R,C,F,z,W,G,J,K,Q=[],X=new Map,Y=e[0];const Z=e=>e[17];for(let t=0;t<Y.length;t+=1){let a=fe(e,Y,t),s=Z(a);X.set(s,Q[t]=pe(s,a))}return{c(){t=s("p"),a=d("Logo"),i=u(),m=s("label"),b=d("Name"),k=u(),E=s("input"),P=u(),x=s("label"),w=d("Link"),L=u(),D=s("input"),S=u(),O=s("div"),A=s("label"),V=d("Image"),j=u(),H=s("input"),M=u(),q=s("p"),R=d("Links"),C=u();for(let e=0;e<Q.length;e+=1)Q[e].c();F=u(),z=s("button"),W=d("Add"),this.h()},l(e){t=o(e,"P",{});var s=n(t);a=h(s,"Logo"),s.forEach(r),i=f(e),m=o(e,"LABEL",{for:!0});var l=n(m);b=h(l,"Name"),l.forEach(r),k=f(e),E=o(e,"INPUT",{id:!0,type:!0}),P=f(e),x=o(e,"LABEL",{for:!0});var c=n(x);w=h(c,"Link"),c.forEach(r),L=f(e),D=o(e,"INPUT",{id:!0,type:!0}),S=f(e),O=o(e,"DIV",{class:!0});var d=n(O);A=o(d,"LABEL",{for:!0});var u=n(A);V=h(u,"Image"),u.forEach(r),j=f(d),H=o(d,"INPUT",{id:!0,type:!0,class:!0}),d.forEach(r),M=f(e),q=o(e,"P",{});var p=n(q);R=h(p,"Links"),p.forEach(r),C=f(e);for(let t=0;t<Q.length;t+=1)Q[t].l(e);F=f(e),z=o(e,"BUTTON",{});var g=n(z);W=h(g,"Add"),g.forEach(r),this.h()},h(){l(m,"for","logo-name-input"),l(E,"id","logo-name-input"),l(E,"type","text"),l(x,"for","logo-href"),l(D,"id","logo-href"),l(D,"type","text"),l(A,"for","logo-image-upload"),l(H,"id","logo-image-upload"),l(H,"type","file"),l(H,"class","svelte-1ss6k92"),l(O,"class","logo-image-upload-container")},m(s,o){c(s,t,o),p(t,a),c(s,i,o),c(s,m,o),p(m,b),c(s,k,o),c(s,E,o),$(E,e[1]),c(s,P,o),c(s,x,o),p(x,w),c(s,L,o),c(s,D,o),$(D,e[2]),c(s,S,o),c(s,O,o),p(O,A),p(A,V),p(O,j),p(O,H),c(s,M,o),c(s,q,o),p(q,R),c(s,C,o);for(let e=0;e<Q.length;e+=1)Q[e].m(s,o);c(s,F,o),c(s,z,o),p(z,W),G=!0,J||(K=[g(E,"input",e[7]),g(E,"keyup",e[3]),g(D,"input",e[8]),g(D,"keyup",e[3]),g(z,"click",e[11])],J=!0)},p(e,[t]){if(2&t&&E.value!==e[1]&&$(E,e[1]),4&t&&D.value!==e[2]&&$(D,e[2]),41&t){const a=e[0];y(),Q=B(Q,t,Z,1,e,a,X,F.parentNode,N,pe,F,fe),U()}},i(e){if(!G){for(let e=0;e<Y.length;e+=1)I(Q[e]);G=!0}},o(e){for(let e=0;e<Q.length;e+=1)T(Q[e]);G=!1},d(e){e&&r(t),e&&r(i),e&&r(m),e&&r(k),e&&r(E),e&&r(P),e&&r(x),e&&r(L),e&&r(D),e&&r(S),e&&r(O),e&&r(M),e&&r(q),e&&r(C);for(let t=0;t<Q.length;t+=1)Q[t].d(e);e&&r(F),e&&r(z),J=!1,v(K)}}}function me(e,t,a){let s;L(e,M,e=>a(13,s=e));let o,{elementId:n}=t,r=q(s,n),l=r?r.name:"",c=r?r.href:"";const i=()=>{R(C({elementId:n,menuData:o,logoData:r}))},d=()=>{a(0,o=[...o,{text:"New Item",href:""}]),i()};return e.$$set=e=>{"elementId"in e&&a(6,n=e.elementId)},e.$$.update=()=>{8256&e.$$.dirty&&a(0,o=s.elementProps[n].menuData||[])},[o,l,c,()=>{r=Object.assign(Object.assign({},r),{name:l,href:c}),i()},d,e=>{a(0,o=o.filter((t,a)=>a!==e)),i()},n,function(){l=this.value,a(1,l)},function(){c=this.value,a(2,c)},function(e,t){t.text=e,a(0,o),a(13,s),a(6,n)},function(e,t){t.href=e,a(0,o),a(13,s),a(6,n)},()=>d()]}class ve extends e{constructor(e){super(),t(this,e,me,ge,a,{elementId:6})}}function $e(e){let t,a,l,u;return{c(){t=s("button"),a=d("Select Parent")},l(e){t=o(e,"BUTTON",{});var s=n(t);a=h(s,"Select Parent"),s.forEach(r)},m(s,o){c(s,t,o),p(t,a),l||(u=g(t,"click",e[2]),l=!0)},p:i,i:i,o:i,d(e){e&&r(t),l=!1,u()}}}function be(e,t,a){let s;L(e,M,e=>a(0,s=e));const o=e=>{let t=F(e),a=z({store:e,blockId:t})||W({store:e,blockId:t});R(G({id:a}))};return[s,o,()=>o(s)]}class ke extends e{constructor(e){super(),t(this,e,be,$e,a,{})}}function Ee(e){let t,a,i,b,x,y,B,N,U,L,D,S,O,A,V,j,H,M,q,R,C,F,z,W,G,K,Q,X,Y,Z,_,ee=J(e[2])?"Split Vertically":"Split Horizontally";return b=new ke({}),{c(){t=s("h3"),a=d("Block Settings"),i=u(),k(b.$$.fragment),x=u(),y=s("button"),B=d(ee),N=u(),U=s("button"),L=d("Delete Block"),D=u(),S=s("div"),O=s("label"),A=d("Background Image"),V=u(),j=s("input"),H=u(),M=s("label"),q=d("Background Color"),R=u(),C=s("div"),F=s("input"),z=u(),W=s("button"),G=d("Set"),K=u(),Q=s("button"),X=d("Reset Background"),this.h()},l(e){t=o(e,"H3",{});var s=n(t);a=h(s,"Block Settings"),s.forEach(r),i=f(e),E(b.$$.fragment,e),x=f(e),y=o(e,"BUTTON",{});var l=n(y);B=h(l,ee),l.forEach(r),N=f(e),U=o(e,"BUTTON",{});var c=n(U);L=h(c,"Delete Block"),c.forEach(r),D=f(e),S=o(e,"DIV",{class:!0});var d=n(S);O=o(d,"LABEL",{for:!0,class:!0});var u=n(O);A=h(u,"Background Image"),u.forEach(r),V=f(d),j=o(d,"INPUT",{type:!0,id:!0,class:!0}),H=f(d),M=o(d,"LABEL",{for:!0,class:!0});var p=n(M);q=h(p,"Background Color"),p.forEach(r),R=f(d),C=o(d,"DIV",{class:!0});var g=n(C);F=o(g,"INPUT",{id:!0,type:!0,class:!0}),z=f(g),W=o(g,"BUTTON",{class:!0});var m=n(W);G=h(m,"Set"),m.forEach(r),g.forEach(r),d.forEach(r),K=f(e),Q=o(e,"BUTTON",{class:!0});var v=n(Q);X=h(v,"Reset Background"),v.forEach(r),this.h()},h(){l(O,"for","background-image-upload"),l(O,"class","svelte-5hiwhc"),l(j,"type","file"),l(j,"id","background-image-upload"),l(j,"class","svelte-5hiwhc"),l(M,"for","background-color-picker"),l(M,"class","svelte-5hiwhc"),l(F,"id","background-color-picker"),l(F,"type","color"),l(F,"class","svelte-5hiwhc"),l(W,"class","color-picker-btn svelte-5hiwhc"),l(C,"class","color-setting-container svelte-5hiwhc"),l(S,"class","input-container"),l(Q,"class","reset-background svelte-5hiwhc")},m(s,o){c(s,t,o),p(t,a),c(s,i,o),P(b,s,o),c(s,x,o),c(s,y,o),p(y,B),c(s,N,o),c(s,U,o),p(U,L),c(s,D,o),c(s,S,o),p(S,O),p(O,A),p(S,V),p(S,j),e[10](j),p(S,H),p(S,M),p(M,q),p(S,R),p(S,C),p(C,F),$(F,e[1]),p(C,z),p(C,W),p(W,G),c(s,K,o),c(s,Q,o),p(Q,X),Y=!0,Z||(_=[g(y,"click",e[8]),g(U,"click",e[9]),g(j,"change",e[5]),g(F,"input",e[11]),g(W,"click",e[7]),g(Q,"click",e[6])],Z=!0)},p(e,[t]){(!Y||4&t)&&ee!==(ee=J(e[2])?"Split Vertically":"Split Horizontally")&&m(B,ee),2&t&&$(F,e[1])},i(e){Y||(I(b.$$.fragment,e),Y=!0)},o(e){T(b.$$.fragment,e),Y=!1},d(a){a&&r(t),a&&r(i),w(b,a),a&&r(x),a&&r(y),a&&r(N),a&&r(U),a&&r(D),a&&r(S),e[10](null),a&&r(K),a&&r(Q),Z=!1,v(_)}}}function Pe(e,t,a){let s,o,n;L(e,M,e=>a(2,s=e));let r="#000000";const l=()=>{K(n,s)},c=()=>{Q(n)};return e.$$.update=()=>{4&e.$$.dirty&&(n=F(s))},[o,r,s,l,c,()=>{if(o.files&&o.files[0]){let e=URL.createObjectURL(o.files[0]);console.log("tempUrl",e),R(X({blockId:n,url:e,reload:!0})),console.log("blockProps",s.blockProps[n]),ne({file:o.files[0]}).then(e=>{R(X({blockId:n,url:e.data.data.url}))}).catch(()=>console.log("handleUpload: failed to upload to host"))}},()=>{R(X({blockId:n,reload:!0})),R(Y({blockId:n,color:""}))},()=>{R(Y({blockId:n,color:r}))},()=>l(),()=>c(),function(e){D[e?"unshift":"push"](()=>{o=e,a(0,o)})},function(){r=this.value,a(1,r)}]}class xe extends e{constructor(e){super(),t(this,e,Pe,Ee,a,{})}}function Ie(e){let t,a,i,$,b,k,E,P,x,w,y,B,N,U,L,D,S,j,H,M,q,R,C="Status: "+(e[0].saved?"Saved":"Modified"),F=e[0].pageProps.editingLayout?"Preview Page":"Edit Page",z=e[0].published?"Unpublish Page":"Publish Page",W=e[0].pageProps.editingLayout?"Preview":"Edit";const G=e[5].default,J=O(G,e,e[4],null);return{c(){t=s("div"),a=s("div"),i=d(C),$=u(),b=s("button"),k=d("x"),E=u(),P=s("button"),x=d(F),w=u(),y=s("button"),B=d(z),N=u(),J&&J.c(),U=u(),L=s("button"),D=d("Show Toolbar"),S=u(),j=s("button"),H=d(W),this.h()},l(e){t=o(e,"DIV",{id:!0,class:!0});var s=n(t);a=o(s,"DIV",{class:!0});var l=n(a);i=h(l,C),l.forEach(r),$=f(s),b=o(s,"BUTTON",{class:!0});var c=n(b);k=h(c,"x"),c.forEach(r),E=f(s),P=o(s,"BUTTON",{class:!0});var d=n(P);x=h(d,F),d.forEach(r),w=f(s),y=o(s,"BUTTON",{class:!0});var u=n(y);B=h(u,z),u.forEach(r),N=f(s),J&&J.l(s),s.forEach(r),U=f(e),L=o(e,"BUTTON",{class:!0});var p=n(L);D=h(p,"Show Toolbar"),p.forEach(r),S=f(e),j=o(e,"BUTTON",{class:!0});var g=n(j);H=h(g,W),g.forEach(r),this.h()},h(){l(a,"class","status svelte-1taoa0b"),l(b,"class","close-toolbar-btn svelte-1taoa0b"),l(P,"class","svelte-1taoa0b"),l(y,"class","svelte-1taoa0b"),l(t,"id","toolbar"),l(t,"class","svelte-1taoa0b"),A(t,"hidden",!e[0].pageProps.showToolbar),l(L,"class","toolbar-toggle svelte-1taoa0b"),A(L,"hidden",Z(e[0])),l(j,"class","preview-btn svelte-1taoa0b"),A(j,"hidden",Z(e[0]))},m(s,o){c(s,t,o),p(t,a),p(a,i),p(t,$),p(t,b),p(b,k),p(t,E),p(t,P),p(P,x),p(t,w),p(t,y),p(y,B),p(t,N),J&&J.m(t,null),c(s,U,o),c(s,L,o),p(L,D),c(s,S,o),c(s,j,o),p(j,H),M=!0,q||(R=[g(b,"click",e[2]),g(P,"click",e[1]),g(y,"click",e[3]),g(L,"click",e[2]),g(j,"click",e[1])],q=!0)},p(e,[a]){(!M||1&a)&&C!==(C="Status: "+(e[0].saved?"Saved":"Modified"))&&m(i,C),(!M||1&a)&&F!==(F=e[0].pageProps.editingLayout?"Preview Page":"Edit Page")&&m(x,F),(!M||1&a)&&z!==(z=e[0].published?"Unpublish Page":"Publish Page")&&m(B,z),J&&J.p&&16&a&&V(J,G,e,e[4],a,null,null),1&a&&A(t,"hidden",!e[0].pageProps.showToolbar),1&a&&A(L,"hidden",Z(e[0])),(!M||1&a)&&W!==(W=e[0].pageProps.editingLayout?"Preview":"Edit")&&m(H,W),1&a&&A(j,"hidden",Z(e[0]))},i(e){M||(I(J,e),M=!0)},o(e){T(J,e),M=!1},d(e){e&&r(t),J&&J.d(e),e&&r(U),e&&r(L),e&&r(S),e&&r(j),q=!1,v(R)}}}function Te(e,t,a){let s;L(e,M,e=>a(0,s=e));let{$$slots:o={},$$scope:n}=t;return e.$$set=e=>{"$$scope"in e&&a(4,n=e.$$scope)},[s,()=>{s.pageProps.editingLayout&&R(G({id:""})),R(_()),R(ee())},()=>R(te()),()=>R(ae()),n,o]}class we extends e{constructor(e){super(),t(this,e,Te,Ie,a,{})}}function ye(e){let t;return{c(){t=d("Select a block to change its settings")},l(e){t=h(e,"Select a block to change its settings")},m(e,a){c(e,t,a)},p:i,i:i,o:i,d(e){e&&r(t)}}}function Be(e){let t,a,i,g,m,v,$,x="menu"===e[2](e[0]).type;t=new xe({});let B=x&&Ne(e);return{c(){k(t.$$.fragment),a=u(),i=s("h3"),g=d("Element Settings"),m=u(),B&&B.c(),v=b(),this.h()},l(e){E(t.$$.fragment,e),a=f(e),i=o(e,"H3",{class:!0});var s=n(i);g=h(s,"Element Settings"),s.forEach(r),m=f(e),B&&B.l(e),v=b(),this.h()},h(){l(i,"class","element-title svelte-1to17tn")},m(e,s){P(t,e,s),c(e,a,s),c(e,i,s),p(i,g),c(e,m,s),B&&B.m(e,s),c(e,v,s),$=!0},p(e,t){1&t&&(x="menu"===e[2](e[0]).type),x?B?(B.p(e,t),1&t&&I(B,1)):(B=Ne(e),B.c(),I(B,1),B.m(v.parentNode,v)):B&&(y(),T(B,1,1,()=>{B=null}),U())},i(e){$||(I(t.$$.fragment,e),I(B),$=!0)},o(e){T(t.$$.fragment,e),T(B),$=!1},d(e){w(t,e),e&&r(a),e&&r(i),e&&r(m),B&&B.d(e),e&&r(v)}}}function Ne(e){let t,a;return t=new ve({props:{elementId:e[1](e[0])}}),{c(){k(t.$$.fragment)},l(e){E(t.$$.fragment,e)},m(e,s){P(t,e,s),a=!0},p(e,a){const s={};1&a&&(s.elementId=e[1](e[0])),t.$set(s)},i(e){a||(I(t.$$.fragment,e),a=!0)},o(e){T(t.$$.fragment,e),a=!1},d(e){w(t,e)}}}function Ue(e){let t,a,s,o,n;const l=[Be,ye],i=[];function d(e,a){return 1&a&&(t=!!e[2](e[0])),t?0:1}return a=d(e,-1),s=i[a]=l[a](e),{c(){s.c(),o=b()},l(e){s.l(e),o=b()},m(e,t){i[a].m(e,t),c(e,o,t),n=!0},p(e,t){let n=a;a=d(e,t),a===n?i[a].p(e,t):(y(),T(i[n],1,1,()=>{i[n]=null}),U(),s=i[a],s||(s=i[a]=l[a](e),s.c()),I(s,1),s.m(o.parentNode,o))},i(e){n||(I(s),n=!0)},o(e){T(s),n=!1},d(e){i[a].d(e),e&&r(o)}}}function Le(e){let t,a;return t=new we({props:{$$slots:{default:[Ue]},$$scope:{ctx:e}}}),{c(){k(t.$$.fragment)},l(e){E(t.$$.fragment,e)},m(e,s){P(t,e,s),a=!0},p(e,[a]){const s={};9&a&&(s.$$scope={dirty:a,ctx:e}),t.$set(s)},i(e){a||(I(t.$$.fragment,e),a=!0)},o(e){T(t.$$.fragment,e),a=!1},d(e){w(t,e)}}}function De(e,t,a){let s;L(e,M,e=>a(0,s=e));const o=e=>{let t=(e.pageProps.focusedBlock||{}).id;if(e.blockProps[t])return(e.blockProps[t].elements||[void 0])[0]};return[s,o,e=>{let t=o(e);if(t)return e.elementProps[t]}]}class Se extends e{constructor(e){super(),t(this,e,De,Le,a,{})}}function Oe(e){let t,a,i,d,h,m,v,$,b;return d=new se({}),m=new Se({}),{c(){t=s("main"),a=s("div"),i=s("div"),k(d.$$.fragment),h=u(),k(m.$$.fragment),this.h()},l(e){t=o(e,"MAIN",{class:!0});var s=n(t);a=o(s,"DIV",{class:!0});var l=n(a);i=o(l,"DIV",{class:!0});var c=n(i);E(d.$$.fragment,c),c.forEach(r),l.forEach(r),h=f(s),E(m.$$.fragment,s),s.forEach(r),this.h()},h(){l(i,"class","block svelte-52p31m"),l(a,"class","page svelte-52p31m"),A(a,"makeWayForToolbar",Z(e[1])),l(t,"class","svelte-52p31m"),A(t,"hidden",e[0])},m(s,o){c(s,t,o),p(t,a),p(a,i),P(d,i,null),p(t,h),P(m,t,null),v=!0,$||(b=g(a,"click",e[7]),$=!0)},p(e,[s]){2&s&&A(a,"makeWayForToolbar",Z(e[1])),1&s&&A(t,"hidden",e[0])},i(e){v||(I(d.$$.fragment,e),I(m.$$.fragment,e),v=!0)},o(e){T(d.$$.fragment,e),T(m.$$.fragment,e),v=!1},d(e){e&&r(t),w(d),w(m),$=!1,b()}}}var Ae=function(e,t,a,s){return new(a||(a=Promise))((function(o,n){function r(e){try{c(s.next(e))}catch(e){n(e)}}function l(e){try{c(s.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(r,l)}c((s=s.apply(e,t||[])).next())}))};function Ve(e,t){return Ae(this,void 0,void 0,(function*(){try{const{username:a,pageId:s}=e.params,o=`api/${a}/${s}/`;if(t.username!==a)return void this.redirect(302,`/${a}/${s}`);const n=yield this.fetch(o),r=yield n.json();if(!r){if("true"===e.query.create)return{pageId:s,create:!0,storePreloaded:void 0,owner:a,username:t.username};this.error(404,"Page not found")}return"true"===e.query.create&&this.redirect(302,`/${a}/${s}/edit`),M.set(r),{storePreloaded:r,pageId:s,owner:a,create:!1,username:t.username}}catch(e){this.error(500,e)}}))}function je(e,t,a){let s;L(e,M,e=>a(1,s=e));let{storePreloaded:o}=t,{pageId:n}=t,{owner:r}=t,{create:l}=t,{username:c}=t,i=!0;o&&j(M,s=o,s);const d=()=>{le(c,n,s).then(()=>{console.log("saved"),R(oe())}).catch(()=>console.log("save error:"))},u=()=>{d(),setInterval(()=>{s.saved||d()},5e3),window.onbeforeunload=()=>{s.saved||(alert("Page not saved, confirm to leave?"),d())}},h=()=>{re(r,n).then(e=>{e.data?(console.log("Page already exist, redirecting"),window.location.assign(window.location.href.replace("?create=true",""))):u()}).catch(e=>{console.log("get Page error retrying in 5s",e),setTimeout(h,5e3)})};H(()=>{l?h():u(),a(0,i=!1)});return e.$$set=e=>{"storePreloaded"in e&&a(2,o=e.storePreloaded),"pageId"in e&&a(3,n=e.pageId),"owner"in e&&a(4,r=e.owner),"create"in e&&a(5,l=e.create),"username"in e&&a(6,c=e.username)},[i,s,o,n,r,l,c,()=>R(G({id:""}))]}export default class extends e{constructor(e){super(),t(this,e,je,Oe,a,{storePreloaded:2,pageId:3,owner:4,create:5,username:6})}}export{Ve as preload};
